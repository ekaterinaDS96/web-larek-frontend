# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
<br> 

** Архитектура проекта и реализация классов сделаны на основе проекта "Оно тебе надо" **  (https://github.com/yandex-praktikum/ono-tebe-nado-oop)<br>
## Базовые классы  
### Класс `EventEmitter`

Класс `EventEmitter` - брокер событий, позволяет устанавливать/снимать слушателей событий и вызывать этих слушателей при возниковении событий <br>
`constructor()` - конструктор. <br>
*Свойства класса*:
- `_events: Map<EventName, Set<Subscriber>>` - приватное свойство, хранящее множество подписчиков для каждого события.

*Реализуемые методы*:
- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` - устанавливает обработчик на событие;
- `off(eventName: EventName, callback: Subscriber)` - снимает обработчик с события;
- `emit<T extends object>(eventName: string, data?: T)` - иницирует событие с указанным именем и  данными;
- `onAll(callback: (event: EmitterEvent) => void)` - используется, чтобы слушать все события;
- `offAll()` - сбрасывает все обработчики событий;
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` - делает коллбек триггер, генерирующий событие при вызове.

*Используемые типы данных*:
- `EventName` - имя события;
- `Subscriber` - тип функции-обработчика события;
- `IEvents` - интерфейс для управления событиями.

### Класс `Model`
Класс `Model` - абстрактный класс, который предназначен для работы с данными и используется как для представления, так и для работы с данными.<br>
`constructor(data:Partial<T>, events: IEvents)` - конструктор, на вход принимает исходные данные для модели и объект событий для сообщения об изменениях модели. <br>
*Реализуемые методы*: <br>
- `emitChanges(event: string, payload?: object)` - сообщает всем об изменении модели.
*Используемые типы данных*:
- `IEvents` - интерфейс для работы с событиями;
- `T` - обобщенный тип данных, представляющий структуру данных модели.

### Класс `API`
Класс`API` - обеспечивает работу с данными с сервера, он отвечает за отправку HTTP-запросов и обработку ответов от сервера.<br>
`constructor(baseUrl: string, options: RequestInit)` - конструктор, который на вход принимает базовый URL и общие настройки запросов. <br>
*Свйойства класса*:
- `readonly baseUrl: string` - основной URL для отправки запросов к API;
- `protected options: RequestInit` - базовые настройки запросов.
*Реализуемые методы*:<br>
- `get<T>(uri: string): ApiResponse<T>` - выполняет `GET` запросы к указанному URI, возвращает промис с типизированным ответом от сервера;
- `post<T>(uri: string, data: object, method: ApiPostMethods): ApiResponse<T>` - выполняет `POST` запросы с данными по указанному URI, возвращает промис с типизированным ответом от сервера
 
*Используемые типы данных*:
- `ApiPostMethods` - тип данных, описывающий допустимые методы HTTP-запросов для POST-запросов;
- `ApiResponse<T>` - обобщенный тип данных для ответов API.

 ### Класс `WebLarekAPI`
 Класс `WebLarekAPI` - класс, в котором есть методы для обращения к серверу (получать информацию о товарах или об одном конкретном, и отправлять заказ на сервер). Этот класс расширяет класс `API`.<br>
 `constructor(cdn: string, baseUrl: string, options?: RequestInit)` - конструктор, на вход принимает базовый URL для API и CDN для изображений. <br>
 *Свойства класса*:<br>
 - `readonly cdn: string` - URL для загрузки изображений товаров;
 *Реализуемые методы*:<br>
- `getProductList(): Promise<IProduct[]>` - получает весь список продуктов с сервера;
- `getProductItem(id: string): Promise<IProduct>` - получает информации об одном продукте по его `id`;
- `orderProducts(order: IOrder): Promise<IOrderResult>` - отправляет информацию о заказе на сервер и получает результат.

*Используемые типы данных*:
- `IProduct` - интерфейс данных товара;
- `IOrder` - интерфейс структуры данных заказа;
- `IOrderResult` - интерфейс структуры данных результата заказа;
- `ApiListResponse<T>` - обобщенный тип для ответа списка элементов от API;
- `IWebLarekAPI` - интерфейс, описывающий методы WebLarekAPI.

### Класс `Component`
Класс `*Component` - базовый компонент, обеспечивает работу с DOM-элементами, позволяет <br>
 - отображать/скрывать DOM-элемент;
 - изменять атрибуты элемента;
 - добавление/удаление классов элементов; <br>
 `protected constructor(container: HTMLElement)` - конструктор, на вход принимает контейнер, в котором необходимо создать элемент отображения.
 *Реализуемые методы*:
- `toggleClass(element: HTMLElement, className: string, force?: boolean)` - переключает класс у элемента;
- `protected setText(element: HTMLElement, value: unknown)` - устанавливает текстовое содержимое элемента;
- `setDisabled(element: HTMLElement, state: boolean)` -  устанавливает или удаляет атрибут `disabled`;
- `protected setHidden(element: HTMLElement)` - cкрывает элемент;
- `protected setVisible(element: HTMLElement)` - делает элемент видимым;
- `protected setImage(element: HTMLImageElement, src: string, alt?: string)` - yстанавливает изображение и альтернативный текст для него;
- `render(data?: Partial<T>)` - рендер компонента.

*Используемые типы данных*:
- `T` - oбобщенный тип данных.

## Классы для работы с данными 
Эти классы хранят данные заказа, корзины, карточки, которые пришли с сервера; позволяют вывести и обработать данные <br>
### Класс `AppState`
Класс `AppState` является основной моделью данных для приложения, в нем хранится каталог продуктов, данные о заказе и ошибки валидации форм доставки и контакта. <br>
Этот класс расширяет класс `Model`.<br>
`constructor(data: IAppState)` - конструктор, на вход принимает исходное состояние приложения. <br>
*Свойства класса*:
- `catalog: Product[]` - массив товаров в каталоге;
- `basket: Product[]` - массив товаров в корзине;
- `order: IOrder` - данные о заказе;
- `preview: string | null` - товар для предпросмотра;
- `formErrors: FormErrors` - ошибки форм.

*Реализуемые методы*:
- `clearBasket()` - очистка корзины и генерация соответствующего события;
- `addToBasket(item: Product)` - добавление товара в корзину;
- `removeFromBasket(item: Product)`- удаление товара из корзины;
- `updateBasket()` - обновление состояния корзины;
- `setCatalog(items: IProduct[])` - заполнение каталога товаров;
- `setPreview(item: Product)` - установка товара для предпросмотра;
- `clearOrder()` - очистка данных заказа;
- `setDeliveryField(field: keyof IDelivery, value: string)` - заполнение полей формы доставки;
- `setContactField(field: keyof IContact, value: string)` - заполнение полей формы контакта.
*Используемые типы данных*:
- `IAppState` - интерфейс с общим состоянием приложения. Включает в себя поля каталога товаров, корзины, текущего заказа, предпросмотра товара и ошибок форм;
- `IOrder` - интерфейс структуры заказа. Включает в себя информацию о способе оплаты, адресе доставки, электронной почте, номере телефона, общей стоимости и списка заказанных товаров;
`IDelivery` - интерфейс для определения полей формы заказа, связанные с данными о доставке;
`FormErrors` - интерфейс структуры хранения ошибок валидации форм;
`IContact` - интерфейс формы контактных данных; 
`IProduct` - интерфейс данных товара.

### Класс `Product` 
Класс `Product` отвечает за хранение данных продукта.<br>
`constructor(data: IProduct)` - конструктор, на вход принимает данные продукта согласно интефейсу `IProduct`.<br>
Конструктор и методы наследуются из класса `Model`.
*Свойства класса*:
- `id: string` - идентификатор продукта;
- `title: string` - название товара;
- `price: number | null` - цена товара;
- `description: string` - описание товара;
- `category: string` - категория товара.
- `image: string` - изображение проудкта.
*Используемые типы данных*:
- `IProduct` - интерфейс данных товара.

## Классы для работы с отображением 
В этих классах заполняется информация HTML-элементов, и устанавливаюются обработчики событий на элементы с использованием `EventEmitter` <br><br>
### Класс `Form`
Класс `Form` - класс для работы с формами. <br>
Наследуется от класса `Component` и расширяет его функциональность.<br>
`constructor(container: HTMLFormElement, events: IEvents)` - конструктор, на вход принимает контейнер для формы и элемент для управления событиями. <br>
*Свойства класса*:
- `protected _submit: HTMLButtonElement` - кнопка отправки формы;
- `protected _errors: HTMLElement` - элемент отображения ошибок валидации формы.
*Реализуемые методы*: <br>
- `set valid(value: boolean)` - сеттер валидности формы, изменяет состояние кнопки в зависимости от того валидная форма или нет;
- `set errors(value: string)` - сеттер ошибок валидации формы; 
- `render(state: Partial<T> & IFormState)` - рендер состояния формы с заданными состоянием валидности, ошибками валидации и значениями полей;
- `onInputChange(field: keyof T, value: string)` - обработчик событий ввода, который эмиттирует события изменения для каждого поля формы. 

*Используемые типы данных*:
- `IFormState` - тип данных состояния формы;
- `T` - обобщенный тип данных.

### Класс `Modal`
Класс `Modal` - класс для работы с модальными окнами. <br>
Наследуется от класса `Component` и расширяет его функциональность.<br>
`constructor(container: HTMLElement, events: IEvents)` - конструктор.<br>
*Свойства класса*:
- `protected _closeButton: HTMLButtonElement` - кнопка для закрытия модального окна;
- `protected _content: HTMLElement` - содержимое модального окна.
*Реализуемые методы*:<br>
- `set content(value: HTMLElement)` - сеттер содержимого модального окна; 
- `open()` - открытие модального окна и инициализация сответствующего события;
- `close()` - закрытие модального окна и инициализация соответствующего события;
- `render(data: IModalData)` - рендер модального окна.

*Используемые типы данных*:
- `IModalData` - тип данных с информацией для отображения в модальном окне.

### Класс `Page`
Класс `Page` предназначен для отображения и управления всеми элементами на странице (каталог товаров, количество товаров в корзине). <br>
Наследуется от класса `Component`. <br>
`constructor(container: HTMLElement, events: IEvents)` - конструктор, на вход принимает контейнер страницы и объект для управления событиями. <br>
*Свойства класса*:
- `protected _counter: HTMLElement;` - счетчик корзины;
- `protected _catalog: HTMLElement;` - каталог товаров;
- `protected _wrapper: HTMLElement;` - обертка страницы;
- `protected _basket: HTMLElement;` - корзина товаров.
*Реализуемые методы*:<br>
- `set counter(value: number)` - сеттер количества товаров в корзине;
- `set catalog(items: HTMLElement[])` - сеттер каталога товаров на основе переданного массива;
- `set locked(value: boolean)` - сеттер блокировки страницы на основе переданного значения (необходимо при открытии модальных окон).
*Используемые типы данных*:
- `IPage` - интерфейс описывающий структуры данных для компонента.

### Класс `Card`
Класс `Card` - класс для работы с карточкой товара, используется для отображения и управления карточками, как в каталоге, так и в корзине, а также отвечает за обработку событий пользователя. <br>
Наследуется от класса `Component`. <br>
`constructor(container: HTMLElement, actions?: IActions)` - конструктор, на вход принимает контейнер карточки и действия, которые связаны с ней. <br>
*Свойства класса*:
- `protected _title: HTMLElement;` - название товара;
- `protected _price: HTMLElement;` - цена товара;
- `protected _image?: HTMLImageElement;` - изображение товара;
- `protected _description?: HTMLElement;` - описание товара;
- `protected _button?: HTMLButtonElement;` - кнопка дейтсвия на карточке;
- `protected _category?: HTMLElement;` - категория товара;
- `protected _index?: HTMLElement;` - порядковый номер товара в корзине;
- `protected _buttonTitle: string;` - название кнопки;
*Реализуемые методы*: <br>
- `set id(value: string)`/`get id()` - сеттер и геттер идентификатора карточки;
- `set title(value: string)`/`get title()` - сеттер и геттер заголовка карточки;
- `set price(value: number | null)`/`get price()` - сеттер и геттер цены товара;
- `set category(value: string)`/`get category()` - сеттер и геттер категории товара;
- `set index(value: string)`/`get index()` - сеттер и геттер индекса товара;
- `set image(value: string)` - сеттер изображения товара;
- `set description(value: string)` - сеттер описания товара;
- `set buttonText(value: string)` - сеттер текстового содержания в кнопке;
- `disableButton(value: number | null)` - активация/деактивация кнопки в завимости от цены товара;
- `classByCategory(value: string): string` - задает цвет для категории карточки.
*Используемые типы данных*:
- `ICard` - интерфейс структуры данных для карточки товара;
- `IActions` - интерфейс для действий, которые можно выполнить с карточкой товара.

### Класс `Basket`
Класс `Basket` - класс для отображения корзины, используется для отображения списка товаров в ней и общей стоимости, управления их выбором. <br>
Наследуется от класса `Component`. <br>
`constructor(container: HTMLElement, events: EventEmitter)` - конструктор, на вход принимает контейнер и элемент для управления событиями. <br>
*Свойства класса*:
- `protected _list: HTMLElement` - список товаров в корзине;
- `protected _total: HTMLElement` - общая стоимость заказа;
- `protected _button: HTMLButtonElement` - кнопка перехода к оформлению заказа. <br>
*Реализуемые методы*:<br>
- `set items(items: HTMLElement[])` - сеттер списка товаров в корзине;
- `set total(total: number)` - сеттер общей стоимости товаров в корзине;
- `toggleButton(disabled: boolean)` - активация/деактивация кнопки.
*Используемые типы данных*:
- `IBasketView` - интерфейс структуры данных, используемых для отображения корзины.


### Класс `Success`
Класс `Success` используется для отобажения элемента интерфейса с сообщением о том, что операция прошла успешно. <br>
Наследуется от класса `Component`.<br>
`constructor(container: HTMLElement, actions: ISuccessActions)` - конструктор, на вход принимает контейнер и элемент для работы с событиями. <br>
*Свойства класса*:
- `protected _close: HTMLElement;` - кнокпа закрытия сообщения;
- `protected _total: HTMLElement;` - сообщение о деталях успешной операции.
*Реализуемые методы*:
- `set total(value: string)` - сеттер собщения об итоговой стоимости операции.
*Используемые типы данных*:
- `ISuccess` - интерфейс структуры данных для компонента;
- `ISuccessActions` - интерфейс действий, которые могут быть выполнены в компоненте.


